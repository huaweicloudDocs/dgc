# 新建复合指标<a name="dgc_01_0613"></a>

复合指标是由一个或多个衍生指标叠加计算而成，其中的维度、限定均继承于衍生指标。注意，不能脱离衍生指标、维度和限定的范围，去产生新的维度和限定。

## 前提条件<a name="section78741755761"></a>

您已新建衍生指标，并且衍生指标已通过审核，具体操作请参见[新建衍生指标](新建衍生指标.md)。

## 新建复合指标<a name="zh-cn_topic_0169427441_section1366014219584"></a>

1.  在DGC控制台首页，选择对应工作空间的“规范设计“模块，进入规范设计页面。

    **图 1**  选择规范设计<a name="dgc_01_0623_dgc_01_0009_fig1540042925813"></a>  
    ![](figures/选择规范设计.png "选择规范设计")

2.  在规范设计控制台，单击左侧导航树中的“技术指标“，选择“复合指标“页签。
3.  在“复合指标“页面，在左侧的主题目录中选中一个主题，然后单击“新建“按钮。
4.  在新建复合指标页面，根据页面提示配置以下参数。

    **图 2**  新建复合指标<a name="fig295244044920"></a>  
    ![](figures/新建复合指标.png "新建复合指标")

    **表 1**  新建复合指标参数说明

    <a name="table189524403496"></a>
    <table><thead align="left"><tr id="row2952194015496"><th class="cellrowborder" valign="top" width="16.509999999999998%" id="mcps1.2.3.1.1"><p id="p4952740174918"><a name="p4952740174918"></a><a name="p4952740174918"></a>参数名称</p>
    </th>
    <th class="cellrowborder" valign="top" width="83.49%" id="mcps1.2.3.1.2"><p id="p1295224014910"><a name="p1295224014910"></a><a name="p1295224014910"></a>说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row179521940134920"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p119521240154915"><a name="p119521240154915"></a><a name="p119521240154915"></a>复合指标名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p6952940124913"><a name="p6952940124913"></a><a name="p6952940124913"></a>只能包含中文、英文字母、数字和下划线，且必须以中文或英文字母开头。</p>
    </td>
    </tr>
    <tr id="row10952114064916"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p1595214408492"><a name="p1595214408492"></a><a name="p1595214408492"></a>复合指标编码</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p2952124054918"><a name="p2952124054918"></a><a name="p2952124054918"></a>只能包含英文字母、数字和下划线，且必须以英文字母开头。</p>
    </td>
    </tr>
    <tr id="row106811337231"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p166813312234"><a name="p166813312234"></a><a name="p166813312234"></a>所属主题</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p1770516417474"><a name="p1770516417474"></a><a name="p1770516417474"></a>显示所属的主题信息。您也可以单击<span class="uicontrol" id="uicontrol1569125832613"><a name="uicontrol1569125832613"></a><a name="uicontrol1569125832613"></a>“选择主题”</span>进行选择。</p>
    </td>
    </tr>
    <tr id="row10312161192311"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p4312111162314"><a name="p4312111162314"></a><a name="p4312111162314"></a>统计维度</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p63121111182318"><a name="p63121111182318"></a><a name="p63121111182318"></a>选择来源于衍生指标的统计维度。</p>
    </td>
    </tr>
    <tr id="row193871536132317"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p19387173618233"><a name="p19387173618233"></a><a name="p19387173618233"></a>数据类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p1838753617236"><a name="p1838753617236"></a><a name="p1838753617236"></a>选择复合指标的数据类型。</p>
    </td>
    </tr>
    <tr id="row2841204819238"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p198412048172318"><a name="p198412048172318"></a><a name="p198412048172318"></a>设定表达式</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p5841184882311"><a name="p5841184882311"></a><a name="p5841184882311"></a>选择所需要的衍生指标，并根据实际需求在<span class="parmname" id="parmname15130484305"><a name="parmname15130484305"></a><a name="parmname15130484305"></a>“表达式”</span>中设置表达式。</p>
    </td>
    </tr>
    <tr id="row81112558115"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p58819571096"><a name="p58819571096"></a><a name="p58819571096"></a>告警配置</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p1288145713920"><a name="p1288145713920"></a><a name="p1288145713920"></a>由衍生指标和表达式组成，表达式由告警参数和逻辑运算符组成。在指标运行时，系统将计算出告警条件表达式的结果，并根据表达式的结果是否为真来判断是否触发告警。如果表达式的结果为真则触发质量告警，结果为假则不触发质量告警。</p>
    </td>
    </tr>
    <tr id="row179522400498"><td class="cellrowborder" valign="top" width="16.509999999999998%" headers="mcps1.2.3.1.1 "><p id="p095314074919"><a name="p095314074919"></a><a name="p095314074919"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="83.49%" headers="mcps1.2.3.1.2 "><p id="p14953640184915"><a name="p14953640184915"></a><a name="p14953640184915"></a>描述信息。支持的长度为0~600个字符。</p>
    </td>
    </tr>
    </tbody>
    </table>

5.  在页面下方，单击“试运行“按钮，然后在弹出框中单击“试运行“按钮，测试所设置的复合指标是否可以正常运行。

    如果试运行失败，请根据错误提示定位错误原因，将配置修改正确后，再单击“试运行“按钮进行重试。

6.  如果试运行成功，单击“发布“，提交发布审核。
7.  在弹出框中单击“确认提交”，提交审核。
8.  等待审核人员审核。

    审核通过后，复合指标就创建好了。


## 编辑复合指标<a name="section113941614131710"></a>

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。

    **图 3**  复合指标<a name="fig171722283182"></a>  
    ![](figures/复合指标.png "复合指标")

2.  在复合指标列表中，找到需要编辑的复合指标，单击“编辑“，进入“编辑复合指标“页面。
3.  根据实际需要修改配置参数。参数说明请参见[表1](#table189524403496)。
4.  在页面下方，单击“试运行“按钮，然后在弹出框中单击“试运行“按钮，测试所设置的复合指标是否可以正常运行。

    如果试运行失败，请根据错误提示定位错误原因，将配置修改正确后，再单击“试运行“按钮进行重试。

5.  如果试运行成功，单击“发布“，提交发布审核。
6.  在弹出框中单击“确认提交”，提交审核。

## 发布复合指标<a name="section156611445152811"></a>

当您新建或编辑复合指标后，需要发布复合指标，才能使其生效。如果复合指标处于待发布、已发布或待下线状态，则无法发布。

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。
2.  在复合指标列表中，勾选需要发布的复合指标，单击“发布“按钮，弹出“批量发布“对话框。
3.  确认无误后，单击“确认提交“，提交审核。

## 查看发布历史<a name="section1027081944619"></a>

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。
2.  在复合指标列表中，找到需要查看的复合指标，单击“更多 \> 发布历史“，将显示“发布历史“页面。
3.  在“发布历史”中，您可以查看复合指标的发布历史和版本对比信息。

## 预览SQL<a name="section5693111212495"></a>

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。
2.  在复合指标列表中，找到需要查看的复合指标，单击“更多 \> 预览SQL“，弹出“预览SQL“对话框。
3.  在“预览SQL”中，您可以查看SQL语句，也可以复制SQL。

## 下线复合指标<a name="section158861731175012"></a>

对于已发布的复合指标，如果不在需要使用，可以将其下线。

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。
2.  在复合指标列表中，勾选需要下线的复合指标，单击“下线“按钮，弹出“批量下线“对话框。
3.  确认无误后，单击“确认提交“。

## 删除复合指标<a name="section1789171115266"></a>

1.  在规范设计控制台，单击左侧导航树的“技术指标“，然后选择“复合指标“页签，进入复合指标页面。
2.  在复合指标列表中，勾选需要删除的复合指标，单击列表上方的“更多 \>删除“按钮，系统弹出“删除“对话框。
3.  单击“确定“。

