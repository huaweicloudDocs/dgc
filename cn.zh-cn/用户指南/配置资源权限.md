# 配置资源权限<a name="dgc_01_1006"></a>

本章主要介绍如何通过创建权限策略来实现资源权限控制，按需为用户分配最小权限，从而降低企业数据信息安全风险。权限策略配置完成后1分钟左右生效。

## 前提条件<a name="section12490010172414"></a>

已在管理中心创建“数据连接类型”为“MapReduce服务（MRS Ranger）”并且MRS集群版本为3.0.0及以上的MRS Ranger数据连接。如何创建请参考[创建数据连接](https://support.huaweicloud.com/usermanual-dgc/dgc_01_0009.html)。

## 创建HDFS权限策略<a name="section176917398372"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 1**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略HDFS组件下“hacluster”的“配置“  ，进入配置界面单击“创建“，新建权限策略。

    **图 2**  新建权限策略<a name="fig71151350182315"></a>  
    ![](figures/新建权限策略.png "新建权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 3**  配置权限策略<a name="fig975312152813"></a>  
    ![](figures/配置权限策略.png "配置权限策略")

    **表 1**  配置HDFS权限策略参数说明

    <a name="table177118297118"></a>
    <table><thead align="left"><tr id="row5661729615"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p156519291716"><a name="p156519291716"></a><a name="p156519291716"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p2661629213"><a name="p2661629213"></a><a name="p2661629213"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row66610291118"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1866152911117"><a name="p1866152911117"></a><a name="p1866152911117"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p14663295115"><a name="p14663295115"></a><a name="p14663295115"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row106702918115"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p14671429210"><a name="p14671429210"></a><a name="p14671429210"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p667829017"><a name="p667829017"></a><a name="p667829017"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row166715297111"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p18673294116"><a name="p18673294116"></a><a name="p18673294116"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p714010131231"><a name="p714010131231"></a><a name="p714010131231"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p185812022173111"><a name="p185812022173111"></a><a name="p185812022173111"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname1525331512348"><a name="parmname1525331512348"></a><a name="parmname1525331512348"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade85811522143116"><a name="menucascade85811522143116"></a><a name="menucascade85811522143116"></a>“<span class="uicontrol" id="uicontrol1958116224318"><a name="uicontrol1958116224318"></a><a name="uicontrol1958116224318"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row166811294116"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p166782914118"><a name="p166782914118"></a><a name="p166782914118"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p176872912113"><a name="p176872912113"></a><a name="p176872912113"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row12685293118"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p106812294113"><a name="p106812294113"></a><a name="p106812294113"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p14686291711"><a name="p14686291711"></a><a name="p14686291711"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row8688296113"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p3681529213"><a name="p3681529213"></a><a name="p3681529213"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p46812911112"><a name="p46812911112"></a><a name="p46812911112"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row1758963641810"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p15590133631814"><a name="p15590133631814"></a><a name="p15590133631814"></a>资源路径</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1159033617181"><a name="p1159033617181"></a><a name="p1159033617181"></a>访问权限控制的HDFS路径。</p>
    </td>
    </tr>
    <tr id="row79531755142317"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p79541755162320"><a name="p79541755162320"></a><a name="p79541755162320"></a>递归</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p39547554236"><a name="p39547554236"></a><a name="p39547554236"></a>开启表示资源路径为递归方式。关闭表示资源路径为非递归方式。默认开启。</p>
    </td>
    </tr>
    <tr id="row187062918110"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p4701929415"><a name="p4701929415"></a><a name="p4701929415"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p47052916112"><a name="p47052916112"></a><a name="p47052916112"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row170122910112"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p207011291112"><a name="p207011291112"></a><a name="p207011291112"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p13701291114"><a name="p13701291114"></a><a name="p13701291114"></a>定义允许访问的用户和用户组。</p>
    <a name="ul5194115385316"></a><a name="ul5194115385316"></a><ul id="ul5194115385316"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row18701290113"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p770122918111"><a name="p770122918111"></a><a name="p770122918111"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p157042917119"><a name="p157042917119"></a><a name="p157042917119"></a>允许访问勾选<span class="parmname" id="parmname20201113993718"><a name="parmname20201113993718"></a><a name="parmname20201113993718"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p97016291116"><a name="p97016291116"></a><a name="p97016291116"></a>禁止访问勾选<span class="parmname" id="parmname27816122375"><a name="parmname27816122375"></a><a name="parmname27816122375"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row1570122913111"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p7701929414"><a name="p7701929414"></a><a name="p7701929414"></a>拒绝所有其他访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p4701029712"><a name="p4701029712"></a><a name="p4701029712"></a>勾选此项表示只有策略中<span class="parmname" id="parmname4518174217398"><a name="parmname4518174217398"></a><a name="parmname4518174217398"></a>“允许访问”</span>指定的用户或用户组可以访问，其他用户均禁止访问。</p>
    </td>
    </tr>
    <tr id="row18712029516"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1700291712"><a name="p1700291712"></a><a name="p1700291712"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p168424194214"><a name="p168424194214"></a><a name="p168424194214"></a>不勾选<span class="parmname" id="parmname189311245194417"><a name="parmname189311245194417"></a><a name="parmname189311245194417"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul4679554449"></a><a name="ul4679554449"></a><ul id="ul4679554449"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Hive访问权限策略<a name="section46911545493"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 4**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_1"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Hive组件的“配置“  ，进入配置界面选择“访问“页签，单击“创建“，新建权限策略。

    **图 5**  新建权限策略入口<a name="fig162929012279"></a>  
    ![](figures/新建权限策略入口.png "新建权限策略入口")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 6**  配置Hive权限策略<a name="fig86939412499"></a>  
    ![](figures/配置Hive权限策略.png "配置Hive权限策略")

    权限策略参数说明表：

    **表 2**  Hive权限策略参数说明表

    <a name="table166938474912"></a>
    <table><thead align="left"><tr id="row9693440496"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p156931946492"><a name="p156931946492"></a><a name="p156931946492"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p769419410499"><a name="p769419410499"></a><a name="p769419410499"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row8694134114910"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p196948464914"><a name="p196948464914"></a><a name="p196948464914"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p186942415491"><a name="p186942415491"></a><a name="p186942415491"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row2694147499"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1694124104913"><a name="p1694124104913"></a><a name="p1694124104913"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1069418410491"><a name="p1069418410491"></a><a name="p1069418410491"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row26941541493"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p76945411497"><a name="p76945411497"></a><a name="p76945411497"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1769434134910"><a name="p1769434134910"></a><a name="p1769434134910"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p1969416444913"><a name="p1969416444913"></a><a name="p1969416444913"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname9694144174914"><a name="parmname9694144174914"></a><a name="parmname9694144174914"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade146944412498"><a name="menucascade146944412498"></a><a name="menucascade146944412498"></a>“<span class="uicontrol" id="uicontrol196941414915"><a name="uicontrol196941414915"></a><a name="uicontrol196941414915"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row2069434114919"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p769416416497"><a name="p769416416497"></a><a name="p769416416497"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p369512410492"><a name="p369512410492"></a><a name="p369512410492"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row96951646493"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p269519416492"><a name="p269519416492"></a><a name="p269519416492"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p56951047497"><a name="p56951047497"></a><a name="p56951047497"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row569512417495"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p669514134914"><a name="p669514134914"></a><a name="p669514134914"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p196956444915"><a name="p196956444915"></a><a name="p196956444915"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row869544144912"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p669554124912"><a name="p669554124912"></a><a name="p669554124912"></a>数据库</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p769511444918"><a name="p769511444918"></a><a name="p769511444918"></a>必填项，此项表示需要进行权限控制的数据库，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row569594114913"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1469544204910"><a name="p1469544204910"></a><a name="p1469544204910"></a>数据表</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p8695194194919"><a name="p8695194194919"></a><a name="p8695194194919"></a>必填项，此项表示需要进行权限控制的数据表，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row469513418494"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1569520411493"><a name="p1569520411493"></a><a name="p1569520411493"></a>列</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p146964415497"><a name="p146964415497"></a><a name="p146964415497"></a>必填项，此项表示需要进行权限控制的列，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row166961441497"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p169634204910"><a name="p169634204910"></a><a name="p169634204910"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1569610413496"><a name="p1569610413496"></a><a name="p1569610413496"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row106965411493"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p56968418495"><a name="p56968418495"></a><a name="p56968418495"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p069612474919"><a name="p069612474919"></a><a name="p069612474919"></a>定义允许访问的用户和用户组。</p>
    <a name="ul169620424920"></a><a name="ul169620424920"></a><ul id="ul169620424920"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row10696340498"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p369794174911"><a name="p369794174911"></a><a name="p369794174911"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p2069713413497"><a name="p2069713413497"></a><a name="p2069713413497"></a>允许访问勾选<span class="parmname" id="parmname0697649493"><a name="parmname0697649493"></a><a name="parmname0697649493"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p269734134917"><a name="p269734134917"></a><a name="p269734134917"></a>禁止访问勾选<span class="parmname" id="parmname1969714104916"><a name="parmname1969714104916"></a><a name="parmname1969714104916"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row126971348492"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p196972046492"><a name="p196972046492"></a><a name="p196972046492"></a>拒绝所有其他访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p46972413491"><a name="p46972413491"></a><a name="p46972413491"></a>勾选此项表示只有策略中<span class="parmname" id="parmname66971543496"><a name="parmname66971543496"></a><a name="parmname66971543496"></a>“允许访问”</span>指定的用户或用户组可以访问，其他用户均禁止访问。</p>
    </td>
    </tr>
    <tr id="row116975474911"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p13697154174918"><a name="p13697154174918"></a><a name="p13697154174918"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1093712291452"><a name="p1093712291452"></a><a name="p1093712291452"></a>不勾选<span class="parmname" id="parmname109378298454"><a name="parmname109378298454"></a><a name="parmname109378298454"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul17937129194515"></a><a name="ul17937129194515"></a><ul id="ul17937129194515"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Hive脱敏权限策略<a name="section470816335274"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 7**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_2"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Hive组件的“配置“  ，进入配置界面选择“脱敏“页签，单击“创建“，新建权限策略。

    **图 8**  新建权限策略界面<a name="fig57101433132715"></a>  
    ![](figures/新建权限策略界面.png "新建权限策略界面")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 9**  配置Hive权限策略界面<a name="fig97101733182715"></a>  
    ![](figures/配置Hive权限策略界面.png "配置Hive权限策略界面")

    **表 3**  Hive权限策略参数说明表

    <a name="table1671016338279"></a>
    <table><thead align="left"><tr id="row371093382714"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p571093372711"><a name="p571093372711"></a><a name="p571093372711"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p12710123362712"><a name="p12710123362712"></a><a name="p12710123362712"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row371133312711"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p14711163362717"><a name="p14711163362717"></a><a name="p14711163362717"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p137114332276"><a name="p137114332276"></a><a name="p137114332276"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row137111233152715"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p12711153316276"><a name="p12711153316276"></a><a name="p12711153316276"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p20711183318276"><a name="p20711183318276"></a><a name="p20711183318276"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row10711183316270"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p14711333152714"><a name="p14711333152714"></a><a name="p14711333152714"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1871183316279"><a name="p1871183316279"></a><a name="p1871183316279"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p20711133319272"><a name="p20711133319272"></a><a name="p20711133319272"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname1571123314277"><a name="parmname1571123314277"></a><a name="parmname1571123314277"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade1571114336279"><a name="menucascade1571114336279"></a><a name="menucascade1571114336279"></a>“<span class="uicontrol" id="uicontrol17118332279"><a name="uicontrol17118332279"></a><a name="uicontrol17118332279"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row1971193392710"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p16711103302715"><a name="p16711103302715"></a><a name="p16711103302715"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1771123316275"><a name="p1771123316275"></a><a name="p1771123316275"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row771216331272"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p167124331274"><a name="p167124331274"></a><a name="p167124331274"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p17121833152710"><a name="p17121833152710"></a><a name="p17121833152710"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row471215331277"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p8712633142719"><a name="p8712633142719"></a><a name="p8712633142719"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p17712173342712"><a name="p17712173342712"></a><a name="p17712173342712"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row11712333162719"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p971203362714"><a name="p971203362714"></a><a name="p971203362714"></a>数据库</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1771212337278"><a name="p1771212337278"></a><a name="p1771212337278"></a>必填项，此项表示需要进行权限控制的数据库，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row371212339277"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1171223311271"><a name="p1171223311271"></a><a name="p1171223311271"></a>数据表</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1771217337279"><a name="p1771217337279"></a><a name="p1771217337279"></a>必填项，此项表示需要进行权限控制的数据表，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row1871219333271"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1471353382718"><a name="p1471353382718"></a><a name="p1471353382718"></a>列</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p15713193311277"><a name="p15713193311277"></a><a name="p15713193311277"></a>必填项，此项表示需要进行权限控制的列，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row1371393342717"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p11713933122715"><a name="p11713933122715"></a><a name="p11713933122715"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p57133338274"><a name="p57133338274"></a><a name="p57133338274"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row1271314333272"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p671323312274"><a name="p671323312274"></a><a name="p671323312274"></a>脱敏</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p77139331278"><a name="p77139331278"></a><a name="p77139331278"></a>定义用户或用户组访问数据的脱敏方式。</p>
    <a name="ul13713163352720"></a><a name="ul13713163352720"></a><ul id="ul13713163352720"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>脱敏方式：按照该参数选定的指对Hive表中需要进行权限控制的列进行脱敏。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Hive行级过滤器权限策略<a name="section1351855772711"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 10**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_3"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Hive组件的“配置“  ，进入配置界面选择“行级过滤器“页签，单击“创建“，新建权限策略。

    **图 11**  创建Hive行级过滤器权限策略<a name="fig1751814571272"></a>  
    ![](figures/创建Hive行级过滤器权限策略.png "创建Hive行级过滤器权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 12**  配置Hive权限策略参数<a name="fig6519757132710"></a>  
    ![](figures/配置Hive权限策略参数.png "配置Hive权限策略参数")

    **表 4**  Hive权限策略参数说明表

    <a name="table4519357182712"></a>
    <table><thead align="left"><tr id="row951935719273"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p851915576275"><a name="p851915576275"></a><a name="p851915576275"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p16519757132717"><a name="p16519757132717"></a><a name="p16519757132717"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row16519145712279"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1151910579274"><a name="p1151910579274"></a><a name="p1151910579274"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p8519115762713"><a name="p8519115762713"></a><a name="p8519115762713"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row1951916578273"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1451915579278"><a name="p1451915579278"></a><a name="p1451915579278"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p151905722720"><a name="p151905722720"></a><a name="p151905722720"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row14519155722714"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1051975711277"><a name="p1051975711277"></a><a name="p1051975711277"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p9519195732719"><a name="p9519195732719"></a><a name="p9519195732719"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p16519115732720"><a name="p16519115732720"></a><a name="p16519115732720"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname1151925712278"><a name="parmname1151925712278"></a><a name="parmname1151925712278"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade45201576277"><a name="menucascade45201576277"></a><a name="menucascade45201576277"></a>“<span class="uicontrol" id="uicontrol5520205712272"><a name="uicontrol5520205712272"></a><a name="uicontrol5520205712272"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row205208576272"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1152017572279"><a name="p1152017572279"></a><a name="p1152017572279"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p11520115722715"><a name="p11520115722715"></a><a name="p11520115722715"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row1752016572279"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p145201557192716"><a name="p145201557192716"></a><a name="p145201557192716"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1652014574271"><a name="p1652014574271"></a><a name="p1652014574271"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row115201157162710"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p10520115716278"><a name="p10520115716278"></a><a name="p10520115716278"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p95201957182714"><a name="p95201957182714"></a><a name="p95201957182714"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row15202572277"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p152015717279"><a name="p152015717279"></a><a name="p152015717279"></a>数据库</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p14520205717271"><a name="p14520205717271"></a><a name="p14520205717271"></a>必填项，此项表示需要进行权限控制的数据库，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row195201657192715"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p12520145716275"><a name="p12520145716275"></a><a name="p12520145716275"></a>数据表</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p852017574275"><a name="p852017574275"></a><a name="p852017574275"></a>必填项，此项表示需要进行权限控制的数据表，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row452095742712"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p135201957162712"><a name="p135201957162712"></a><a name="p135201957162712"></a>列</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1520857112714"><a name="p1520857112714"></a><a name="p1520857112714"></a>必填项，此项表示需要进行权限控制的列，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row155201857172720"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1752012571278"><a name="p1752012571278"></a><a name="p1752012571278"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p15209571278"><a name="p15209571278"></a><a name="p15209571278"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row16520145722712"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1952035732717"><a name="p1952035732717"></a><a name="p1952035732717"></a>行级过滤器</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p18520125717271"><a name="p18520125717271"></a><a name="p18520125717271"></a>定义允许访问的用户和用户组。</p>
    <a name="ul1752015722719"></a><a name="ul1752015722719"></a><ul id="ul1752015722719"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>行级过滤器：根据字段内容进行过滤，格式一般为：属性=属性值。例如：state=1。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建HBase权限策略<a name="section3665185018435"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 13**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_4"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略HBase组件的“配置“  ，进入配置界面单击“创建“，新建权限策略。

    **图 14**  创建HBase权限策略<a name="fig165925018431"></a>  
    ![](figures/创建HBase权限策略.png "创建HBase权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 15**  配置HBase权限策略<a name="fig144661355164520"></a>  
    ![](figures/配置HBase权限策略.png "配置HBase权限策略")

    **表 5**  HBase权限策略参数表

    <a name="table1746625534519"></a>
    <table><thead align="left"><tr id="row446705574512"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p746765574512"><a name="p746765574512"></a><a name="p746765574512"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p8467185514454"><a name="p8467185514454"></a><a name="p8467185514454"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row546716552453"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p124673551454"><a name="p124673551454"></a><a name="p124673551454"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p164674555456"><a name="p164674555456"></a><a name="p164674555456"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row1146715553457"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p346795504518"><a name="p346795504518"></a><a name="p346795504518"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1467455124514"><a name="p1467455124514"></a><a name="p1467455124514"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row9467255124510"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p6467165513459"><a name="p6467165513459"></a><a name="p6467165513459"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p194671755194513"><a name="p194671755194513"></a><a name="p194671755194513"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p204671955144514"><a name="p204671955144514"></a><a name="p204671955144514"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname15467205514512"><a name="parmname15467205514512"></a><a name="parmname15467205514512"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade546718555453"><a name="menucascade546718555453"></a><a name="menucascade546718555453"></a>“<span class="uicontrol" id="uicontrol124671255134514"><a name="uicontrol124671255134514"></a><a name="uicontrol124671255134514"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row17467145510459"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p15468205524511"><a name="p15468205524511"></a><a name="p15468205524511"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p446825554517"><a name="p446825554517"></a><a name="p446825554517"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row7468855104518"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1846815584510"><a name="p1846815584510"></a><a name="p1846815584510"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p15468175515458"><a name="p15468175515458"></a><a name="p15468175515458"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row346875524520"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1346812557456"><a name="p1346812557456"></a><a name="p1346812557456"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p0468195524518"><a name="p0468195524518"></a><a name="p0468195524518"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row1468145514511"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p13468105518456"><a name="p13468105518456"></a><a name="p13468105518456"></a>数据表</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p74686556451"><a name="p74686556451"></a><a name="p74686556451"></a>必填项，此项表示需要进行权限控制的数据表，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row18468145517451"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p546845584520"><a name="p546845584520"></a><a name="p546845584520"></a>列</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p2468055104511"><a name="p2468055104511"></a><a name="p2468055104511"></a>必填项，此项表示需要进行权限控制的列，支持模糊搜索。</p>
    </td>
    </tr>
    <tr id="row20468125517450"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p4468455114512"><a name="p4468455114512"></a><a name="p4468455114512"></a>列族</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p846812551451"><a name="p846812551451"></a><a name="p846812551451"></a>必填项，此项表示HBase中Column Family，多列的集合。</p>
    </td>
    </tr>
    <tr id="row13468175594513"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p19468175515454"><a name="p19468175515454"></a><a name="p19468175515454"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p7468655184518"><a name="p7468655184518"></a><a name="p7468655184518"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row1146810555455"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1846805519458"><a name="p1846805519458"></a><a name="p1846805519458"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p20469105514510"><a name="p20469105514510"></a><a name="p20469105514510"></a>定义允许访问的用户和用户组。</p>
    <a name="ul146914556456"></a><a name="ul146914556456"></a><ul id="ul146914556456"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row14691955164517"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p18469195564511"><a name="p18469195564511"></a><a name="p18469195564511"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p54697558453"><a name="p54697558453"></a><a name="p54697558453"></a>允许访问勾选<span class="parmname" id="parmname204691655144519"><a name="parmname204691655144519"></a><a name="parmname204691655144519"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p1946975524518"><a name="p1946975524518"></a><a name="p1946975524518"></a>禁止访问勾选<span class="parmname" id="parmname0469105518456"><a name="parmname0469105518456"></a><a name="parmname0469105518456"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row164691255144511"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p19469355184515"><a name="p19469355184515"></a><a name="p19469355184515"></a>拒绝所有其他访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1646920554459"><a name="p1646920554459"></a><a name="p1646920554459"></a>勾选此项表示只有策略中<span class="parmname" id="parmname2469255104515"><a name="parmname2469255104515"></a><a name="parmname2469255104515"></a>“允许访问”</span>指定的用户或用户组可以访问，其他用户均禁止访问。</p>
    </td>
    </tr>
    <tr id="row6469125544511"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p34698556458"><a name="p34698556458"></a><a name="p34698556458"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p8778947194513"><a name="p8778947194513"></a><a name="p8778947194513"></a>不勾选<span class="parmname" id="parmname777864744510"><a name="parmname777864744510"></a><a name="parmname777864744510"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul1377911474455"></a><a name="ul1377911474455"></a><ul id="ul1377911474455"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Yarn权限策略<a name="section1870375317183"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 16**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_5"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Yarn组件的“配置“  ，进入配置界面单击“创建“，新建权限策略。

    **图 17**  新建Yarn权限策略<a name="fig9703853111813"></a>  
    ![](figures/新建Yarn权限策略.png "新建Yarn权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，完成策略配置。

    **图 18**  配置Yarn权限策略<a name="fig310525822019"></a>  
    ![](figures/配置Yarn权限策略.png "配置Yarn权限策略")

    **表 6**  Yarn权限策略参数表

    <a name="table960414362017"></a>
    <table><thead align="left"><tr id="row36001143182010"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p7599144322013"><a name="p7599144322013"></a><a name="p7599144322013"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p6599194311202"><a name="p6599194311202"></a><a name="p6599194311202"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row1660064342012"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p96007432207"><a name="p96007432207"></a><a name="p96007432207"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p260094322012"><a name="p260094322012"></a><a name="p260094322012"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row5600443142011"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p18600443112017"><a name="p18600443112017"></a><a name="p18600443112017"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p176009436204"><a name="p176009436204"></a><a name="p176009436204"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row1760010436205"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p2600154314203"><a name="p2600154314203"></a><a name="p2600154314203"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p56008437205"><a name="p56008437205"></a><a name="p56008437205"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p3600164382019"><a name="p3600164382019"></a><a name="p3600164382019"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname26008431203"><a name="parmname26008431203"></a><a name="parmname26008431203"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade2600154318206"><a name="menucascade2600154318206"></a><a name="menucascade2600154318206"></a>“<span class="uicontrol" id="uicontrol7600443172013"><a name="uicontrol7600443172013"></a><a name="uicontrol7600443172013"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row560012433200"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p206008439203"><a name="p206008439203"></a><a name="p206008439203"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p136001643122010"><a name="p136001643122010"></a><a name="p136001643122010"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row260111436203"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1960110430207"><a name="p1960110430207"></a><a name="p1960110430207"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p2601843102016"><a name="p2601843102016"></a><a name="p2601843102016"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row13601343152018"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p17601843172013"><a name="p17601843172013"></a><a name="p17601843172013"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p15601164372013"><a name="p15601164372013"></a><a name="p15601164372013"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row260344318204"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p146021343112016"><a name="p146021343112016"></a><a name="p146021343112016"></a>队列</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p17603144319201"><a name="p17603144319201"></a><a name="p17603144319201"></a>Yarn服务中的资源调度队列。</p>
    </td>
    </tr>
    <tr id="row14603043132015"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p060394311203"><a name="p060394311203"></a><a name="p060394311203"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p16603543172018"><a name="p16603543172018"></a><a name="p16603543172018"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row13603743102014"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1603114312013"><a name="p1603114312013"></a><a name="p1603114312013"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p96031843152016"><a name="p96031843152016"></a><a name="p96031843152016"></a>定义允许访问的用户和用户组。</p>
    <a name="ul2060394310209"></a><a name="ul2060394310209"></a><ul id="ul2060394310209"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row66041143152018"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1960374332010"><a name="p1960374332010"></a><a name="p1960374332010"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p760494312209"><a name="p760494312209"></a><a name="p760494312209"></a>允许访问勾选<span class="parmname" id="parmname1160454362016"><a name="parmname1160454362016"></a><a name="parmname1160454362016"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p19604943192013"><a name="p19604943192013"></a><a name="p19604943192013"></a>禁止访问勾选<span class="parmname" id="parmname1960417432207"><a name="parmname1960417432207"></a><a name="parmname1960417432207"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row1660404318204"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p16604154312014"><a name="p16604154312014"></a><a name="p16604154312014"></a>拒绝所有其他访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p126041143112016"><a name="p126041143112016"></a><a name="p126041143112016"></a>勾选此项表示只有策略中<span class="parmname" id="parmname760474314203"><a name="parmname760474314203"></a><a name="parmname760474314203"></a>“允许访问”</span>指定的用户或用户组可以访问，其他用户均禁止访问。</p>
    </td>
    </tr>
    <tr id="row1360434319209"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p0604164312209"><a name="p0604164312209"></a><a name="p0604164312209"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p17247857184520"><a name="p17247857184520"></a><a name="p17247857184520"></a>不勾选<span class="parmname" id="parmname19247145744512"><a name="parmname19247145744512"></a><a name="parmname19247145744512"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul3247185718457"></a><a name="ul3247185718457"></a><ul id="ul3247185718457"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Kafka权限策略<a name="section1047712512219"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 19**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_6"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Kafka组件的“配置“  ，进入配置界面单击“创建“，新建权限策略。

    **图 20**  新建kafka权限策略<a name="fig54721252225"></a>  
    ![](figures/新建kafka权限策略.png "新建kafka权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 21**  配置Kafka权限策略<a name="fig747365152210"></a>  
    ![](figures/配置Kafka权限策略.png "配置Kafka权限策略")

    **表 7**  Kafka权限策略参数表

    <a name="table11477253227"></a>
    <table><thead align="left"><tr id="row147315162210"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p94736511220"><a name="p94736511220"></a><a name="p94736511220"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p164734552211"><a name="p164734552211"></a><a name="p164734552211"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row747385202212"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p20473195122217"><a name="p20473195122217"></a><a name="p20473195122217"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p347385192214"><a name="p347385192214"></a><a name="p347385192214"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row7473751225"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p447335102210"><a name="p447335102210"></a><a name="p447335102210"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1547355192217"><a name="p1547355192217"></a><a name="p1547355192217"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row154741054226"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p247375162216"><a name="p247375162216"></a><a name="p247375162216"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p34731154226"><a name="p34731154226"></a><a name="p34731154226"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p7473175112216"><a name="p7473175112216"></a><a name="p7473175112216"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname147315522210"><a name="parmname147315522210"></a><a name="parmname147315522210"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade94731357224"><a name="menucascade94731357224"></a><a name="menucascade94731357224"></a>“<span class="uicontrol" id="uicontrol747318510223"><a name="uicontrol747318510223"></a><a name="uicontrol747318510223"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row184741750222"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p54748512228"><a name="p54748512228"></a><a name="p54748512228"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1474155102218"><a name="p1474155102218"></a><a name="p1474155102218"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row10474156229"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p24740522220"><a name="p24740522220"></a><a name="p24740522220"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p447415172213"><a name="p447415172213"></a><a name="p447415172213"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row204748513226"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p84742542218"><a name="p84742542218"></a><a name="p84742542218"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1347465132217"><a name="p1347465132217"></a><a name="p1347465132217"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row1247555112212"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1947520572211"><a name="p1947520572211"></a><a name="p1947520572211"></a>策略条件</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1847535132213"><a name="p1847535132213"></a><a name="p1847535132213"></a>指定可访问Kafka主题的IP地址范围。</p>
    </td>
    </tr>
    <tr id="row1947515516221"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p12475754220"><a name="p12475754220"></a><a name="p12475754220"></a>Topic</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p34757515223"><a name="p34757515223"></a><a name="p34757515223"></a>Kafka集群的消息主题。</p>
    </td>
    </tr>
    <tr id="row94751155221"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1547595202210"><a name="p1547595202210"></a><a name="p1547595202210"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1447515182217"><a name="p1447515182217"></a><a name="p1447515182217"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row147617552211"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p947519572213"><a name="p947519572213"></a><a name="p947519572213"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p547517582210"><a name="p547517582210"></a><a name="p547517582210"></a>定义允许访问的用户和用户组。</p>
    <a name="ul194763582218"></a><a name="ul194763582218"></a><ul id="ul194763582218"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>策略条件：指定可访问Kafka主题的IP地址范围。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row447665192214"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p847611519221"><a name="p847611519221"></a><a name="p847611519221"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p174761452221"><a name="p174761452221"></a><a name="p174761452221"></a>允许访问勾选<span class="parmname" id="parmname247612562217"><a name="parmname247612562217"></a><a name="parmname247612562217"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p19476185132211"><a name="p19476185132211"></a><a name="p19476185132211"></a>禁止访问勾选<span class="parmname" id="parmname1047619512210"><a name="parmname1047619512210"></a><a name="parmname1047619512210"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row104773572211"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p154761562213"><a name="p154761562213"></a><a name="p154761562213"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1773510437462"><a name="p1773510437462"></a><a name="p1773510437462"></a>不勾选<span class="parmname" id="parmname97355433461"><a name="parmname97355433461"></a><a name="parmname97355433461"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul13736143114616"></a><a name="ul13736143114616"></a><ul id="ul13736143114616"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>策略条件：指定可访问Kafka主题的IP地址范围。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 创建Storm权限策略<a name="section017773615238"></a>

1.  在DGC控制台首页，选择对应工作空间的“数据安全“模块，进入数据安全页面。

    **图 22**  选择数据安全<a name="dgc_01_1005_dgc_01_0009_fig1540042925813_7"></a>  
    ![](figures/选择数据安全.png "选择数据安全")

2.  单击左侧导航树中的“资源权限配置“，进入资源权限配置页面。
3.  单击待创建权限策略Storm组件的“配置“  ，进入配置界面单击“创建“，新建权限策略。

    **图 23**  新建Storm权限策略<a name="fig017283692310"></a>  
    ![](figures/新建Storm权限策略.png "新建Storm权限策略")

4.  在弹出的策略配置页配置相关参数，配置完成单击“确定“，策略配置完成。

    **图 24**  配置Storm权限策略<a name="fig61731369230"></a>  
    ![](figures/配置Storm权限策略.png "配置Storm权限策略")

    **表 8**  Storm权限策略参数表

    <a name="table817723617230"></a>
    <table><thead align="left"><tr id="row4173436172314"><th class="cellrowborder" valign="top" width="20.49%" id="mcps1.2.3.1.1"><p id="p9173193615239"><a name="p9173193615239"></a><a name="p9173193615239"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.51%" id="mcps1.2.3.1.2"><p id="p8173736112315"><a name="p8173736112315"></a><a name="p8173736112315"></a>参数描述</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row2173203682312"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p317313612310"><a name="p317313612310"></a><a name="p317313612310"></a>策略类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p31731836142318"><a name="p31731836142318"></a><a name="p31731836142318"></a>根据用户所选服务组件自动生成。包括访问、脱敏、行过滤器，其中脱敏和行过滤器类型是Hive特有的。</p>
    </td>
    </tr>
    <tr id="row1017373619231"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1917393622315"><a name="p1917393622315"></a><a name="p1917393622315"></a>策略状态</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p13173036172312"><a name="p13173036172312"></a><a name="p13173036172312"></a>开启表示权限策略生效，关闭表示权限策略创建成功后不生效。默认开启。</p>
    </td>
    </tr>
    <tr id="row161737368231"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p41730363231"><a name="p41730363231"></a><a name="p41730363231"></a>可覆盖</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p817313612232"><a name="p817313612232"></a><a name="p817313612232"></a>开启可覆盖时，新创建的策略将覆盖当前策略（新策略生效而旧策略不生效）。默认开启。</p>
    <p id="p151738363237"><a name="p151738363237"></a><a name="p151738363237"></a>当用户需要创建一个临时访问策略时，<span class="parmname" id="parmname1173236122313"><a name="parmname1173236122313"></a><a name="parmname1173236122313"></a>“可覆盖”</span>可以配合<span class="menucascade" id="menucascade81731036182317"><a name="menucascade81731036182317"></a><a name="menucascade81731036182317"></a>“<span class="uicontrol" id="uicontrol4173123672314"><a name="uicontrol4173123672314"></a><a name="uicontrol4173123672314"></a>有效时间</span>”</span>一起使用，那么即使临时访问策略超过有效期失效后，也不影响原有的权限策略继续生效。</p>
    </td>
    </tr>
    <tr id="row31747362231"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p517383652317"><a name="p517383652317"></a><a name="p517383652317"></a>审计日志</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p201741436122319"><a name="p201741436122319"></a><a name="p201741436122319"></a>开启表示记录日志，日志内容包括客户端访问时间、客户端IP、客户端用户、操作资源结果等信息。</p>
    </td>
    </tr>
    <tr id="row217463618232"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p8174113613230"><a name="p8174113613230"></a><a name="p8174113613230"></a>策略名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p19174536192310"><a name="p19174536192310"></a><a name="p19174536192310"></a>名称为必填项，只能包含英文字母、数字、下划线和中划线，且长度为1~50个字符，且输入不能为空。</p>
    </td>
    </tr>
    <tr id="row14174436132315"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p31741436142315"><a name="p31741436142315"></a><a name="p31741436142315"></a>描述</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p10174143611235"><a name="p10174143611235"></a><a name="p10174143611235"></a>对策略的描述信息，长度限制在256个字符以内。</p>
    </td>
    </tr>
    <tr id="row2175143632315"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p17175193642312"><a name="p17175193642312"></a><a name="p17175193642312"></a>Topology</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p161751336152314"><a name="p161751336152314"></a><a name="p161751336152314"></a>该参数表示Storm集群中的任务。</p>
    </td>
    </tr>
    <tr id="row151751136172316"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p2017553682313"><a name="p2017553682313"></a><a name="p2017553682313"></a>有效时间</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p117513368232"><a name="p117513368232"></a><a name="p117513368232"></a>用户通过设置开始时间和结束时间来控制策略的生效时间段，可配置多条。</p>
    </td>
    </tr>
    <tr id="row14176143611234"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p19175173692313"><a name="p19175173692313"></a><a name="p19175173692313"></a>允许访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p1017593617233"><a name="p1017593617233"></a><a name="p1017593617233"></a>定义允许访问的用户和用户组。</p>
    <a name="ul1817616364239"></a><a name="ul1817616364239"></a><ul id="ul1817616364239"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义允许访问的用户拥有的权限。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    <tr id="row3176436142314"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p7176113632312"><a name="p7176113632312"></a><a name="p7176113632312"></a>添加排除项</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p117653612311"><a name="p117653612311"></a><a name="p117653612311"></a>允许访问勾选<span class="parmname" id="parmname121769363233"><a name="parmname121769363233"></a><a name="parmname121769363233"></a>“添加排除项”</span>意思是在允许访问的用户组里添加禁止访问的用户。</p>
    <p id="p11761036132316"><a name="p11761036132316"></a><a name="p11761036132316"></a>禁止访问勾选<span class="parmname" id="parmname13176436122310"><a name="parmname13176436122310"></a><a name="parmname13176436122310"></a>“添加排除项”</span>意思是在禁止访问的用户组里添加允许访问的用户。</p>
    </td>
    </tr>
    <tr id="row201761536192318"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p6176836122317"><a name="p6176836122317"></a><a name="p6176836122317"></a>拒绝所有其他访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p517623614234"><a name="p517623614234"></a><a name="p517623614234"></a>勾选此项表示只有策略中<span class="parmname" id="parmname41764361233"><a name="parmname41764361233"></a><a name="parmname41764361233"></a>“允许访问”</span>指定的用户或用户组可以访问，其他用户均禁止访问。</p>
    </td>
    </tr>
    <tr id="row4177103620239"><td class="cellrowborder" valign="top" width="20.49%" headers="mcps1.2.3.1.1 "><p id="p1817616366236"><a name="p1817616366236"></a><a name="p1817616366236"></a>禁止访问</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.51%" headers="mcps1.2.3.1.2 "><p id="p184801410718"><a name="p184801410718"></a><a name="p184801410718"></a>不勾选<span class="parmname" id="parmname52997302813"><a name="parmname52997302813"></a><a name="parmname52997302813"></a>“拒绝所有其他访问”</span>时显示此配置，该配置定义禁止访问的用户和用户组。</p>
    <a name="ul208819279449"></a><a name="ul208819279449"></a><ul id="ul208819279449"><li>用户：MRS服务的用户。</li><li>角色：MRS服务的角色。</li><li>用户组：MRS服务的用户组。</li><li>权限：定义用户禁止的权限类型。权限和用户允许同时为空值，或者同时不为空值。服务相关权限详情请参考<a href="权限管理简介.md#table23037523175">表1</a>。</li><li>委托用户：当勾选此项时，管理权限将分配给适用的用户和组。受委托的管理员可以更新和删除策略，还可以基于原始策略创建子策略。</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


